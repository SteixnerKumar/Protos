
(variables
(L2_EXPLOIT yes no)
(L3_EXPLOIT yes no)
(HAS_C_DATA yes no)
(PRIVS_LEVEL l1 l2 l3)
(C_DATA_ACCESSED yes no)
(EXFIL_ONGOING yes no)
)


(observations
(SCAN_RESULT vuln none critical-data)
(EXEC_RESULT success fail)
)

unnormalized

init [*

(C_DATA_ACCESSED
	(no
	(1.0))
	(yes
	(0.0))
)

(L2_EXPLOIT
	(no
	(0.5))
	(yes
	(0.5))
)

(L3_EXPLOIT
	(no
	(0.5))
	(yes
	(0.5))
)

(EXFIL_ONGOING
	(no
	(1.0))
	(yes
	(0.0))
)

(HAS_C_DATA
	(no
	(0.5))
	(yes
	(0.5))
)

(PRIVS_LEVEL
	(l1 	(1.0))
	(l2 	(0.0))
	(l3 	(0.0))
)

]

action PRIV_ESC

HAS_C_DATA	 (SAMEHAS_C_DATA)
SESSION_PRIVS	(HAS_ROOT_VULN
	(no
	(SESSION_PRIVS
		(admin
			(SESSION_PRIVS'
			(admin
					(1.0))
			(user
					(0.0))
		))
		(user
			(SESSION_PRIVS'
			(admin
					(0.0))
			(user
					(1.0))
		))
	))
	(yes
	(SESSION_PRIVS
		(admin
			(SESSION_PRIVS'
			(admin
					(1.0))
			(user
					(0.0))
		))
		(user
			(SESSION_PRIVS'
			(admin
					(0.9))
			(user
					(0.1))
		))
	))
)
PERSIST_GAINED	 (SAMEPERSIST_GAINED)
C_DATA_ACCESSED	 (SAMEC_DATA_ACCESSED)
FAKE_DATA_ACCESSED	 (SAMEFAKE_DATA_ACCESSED)
EXFIL_ONGOING	 (SAMEEXFIL_ONGOING)
observe
OBS	(SESSION_PRIVS'
	(admin
	(OBS'
		(success
			(1.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(0.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
	(user
	(OBS'
		(success
			(0.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(1.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
)
endobserve
cost (0.5)
endaction


action EXFIL
HAS_ROOT_VULN	 (SAMEHAS_ROOT_VULN)
HAS_C_DATA	 (SAMEHAS_C_DATA)
HAS_FAKE_DATA	 (SAMEHAS_FAKE_DATA)
SESSION_PRIVS	 (SAMESESSION_PRIVS)
PERSIST_GAINED	 (SAMEPERSIST_GAINED)
C_DATA_ACCESSED	 (SAMEC_DATA_ACCESSED)
FAKE_DATA_ACCESSED	 (SAMEFAKE_DATA_ACCESSED)
EXFIL_ONGOING	(C_DATA_ACCESSED
	(no
	(SESSION_PRIVS
		(admin
			(EXFIL_ONGOING
			(no
					(EXFIL_ONGOING'
				(no
							(1.0))
				(yes
							(0.0))
			))
			(yes
					(EXFIL_ONGOING'
				(no
							(1.0))
				(yes
							(0.0))
			))
		))
		(user
			(EXFIL_ONGOING
			(no
					(EXFIL_ONGOING'
				(no
							(1.0))
				(yes
							(0.0))
			))
			(yes
					(EXFIL_ONGOING'
				(no
							(1.0))
				(yes
							(0.0))
			))
		))
	))
	(yes
	(SESSION_PRIVS
		(admin
			(EXFIL_ONGOING
			(no
					(EXFIL_ONGOING'
				(no
							(0.1))
				(yes
							(0.9))
			))
			(yes
					(EXFIL_ONGOING'
				(no
							(0.0))
				(yes
							(1.0))
			))
		))
		(user
			(EXFIL_ONGOING
			(no
					(EXFIL_ONGOING'
				(no
							(0.25))
				(yes
							(0.75))
			))
			(yes
					(EXFIL_ONGOING'
				(no
							(0.0))
				(yes
							(1.0))
			))
		))
	))
)
observe
OBS	(EXFIL_ONGOING'
	(no
	(OBS'
		(success
			(0.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(1.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
	(yes
	(OBS'
		(success
			(1.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(0.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
)
endobserve
cost (0.5)
endaction


action PERM_SCAN
HAS_ROOT_VULN	 (SAMEHAS_ROOT_VULN)
HAS_C_DATA	 (SAMEHAS_C_DATA)
HAS_FAKE_DATA	 (SAMEHAS_FAKE_DATA)
SESSION_PRIVS	 (SAMESESSION_PRIVS)
PERSIST_GAINED	 (SAMEPERSIST_GAINED)
C_DATA_ACCESSED	 (SAMEC_DATA_ACCESSED)
FAKE_DATA_ACCESSED	 (SAMEFAKE_DATA_ACCESSED)
EXFIL_ONGOING	 (SAMEEXFIL_ONGOING)
observe
OBS	(SESSION_PRIVS'
	(admin
	(OBS'
		(success
			(0.0))
		(vuln
			(0.0))
		(admin
			(1.0))
		(none
			(0.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
	(user
	(OBS'
		(success
			(0.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(0.0))
		(user
			(1.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
)
endobserve
cost (0.1)
endaction


action FILE_RECON
HAS_ROOT_VULN	 (SAMEHAS_ROOT_VULN)
HAS_C_DATA	 (SAMEHAS_C_DATA)
HAS_FAKE_DATA	 (SAMEHAS_FAKE_DATA)
SESSION_PRIVS	 (SAMESESSION_PRIVS)
PERSIST_GAINED	 (SAMEPERSIST_GAINED)
C_DATA_ACCESSED	(HAS_C_DATA
	(no
	(SESSION_PRIVS
		(admin
			(C_DATA_ACCESSED
			(no
					(C_DATA_ACCESSED'
				(no
							(1.0))
				(yes
							(0.0))
			))
			(yes
					(C_DATA_ACCESSED'
				(no
							(1.0))
				(yes
							(0.0))
			))
		))
		(user
			(C_DATA_ACCESSED
			(no
					(C_DATA_ACCESSED'
				(no
							(1.0))
				(yes
							(0.0))
			))
			(yes
					(C_DATA_ACCESSED'
				(no
							(1.0))
				(yes
							(0.0))
			))
		))
	))
	(yes
	(SESSION_PRIVS
		(admin
			(C_DATA_ACCESSED
			(no
					(C_DATA_ACCESSED'
				(no
							(0.1))
				(yes
							(0.9))
			))
			(yes
					(C_DATA_ACCESSED'
				(no
							(0.0))
				(yes
							(1.0))
			))
		))
		(user
			(C_DATA_ACCESSED
			(no
					(C_DATA_ACCESSED'
				(no
							(1.0))
				(yes
							(0.0))
			))
			(yes
					(C_DATA_ACCESSED'
				(no
							(0.0))
				(yes
							(1.0))
			))
		))
	))
)
FAKE_DATA_ACCESSED	 (SAMEFAKE_DATA_ACCESSED)
EXFIL_ONGOING	 (SAMEEXFIL_ONGOING)
observe
OBS	(C_DATA_ACCESSED'
	(no
	(OBS'
		(success
			(0.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(1.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
	(yes
	(OBS'
		(success
			(1.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(0.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
)
endobserve
cost (0.1)
endaction


action VULN_SCAN
HAS_ROOT_VULN	 (SAMEHAS_ROOT_VULN)
HAS_C_DATA	 (SAMEHAS_C_DATA)
HAS_FAKE_DATA	 (SAMEHAS_FAKE_DATA)
SESSION_PRIVS	 (SAMESESSION_PRIVS)
PERSIST_GAINED	 (SAMEPERSIST_GAINED)
C_DATA_ACCESSED	 (SAMEC_DATA_ACCESSED)
FAKE_DATA_ACCESSED	 (SAMEFAKE_DATA_ACCESSED)
EXFIL_ONGOING	 (SAMEEXFIL_ONGOING)
observe
OBS	(HAS_ROOT_VULN'
	(no
	(OBS'
		(success
			(0.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(1.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
	(yes
	(OBS'
		(success
			(0.0))
		(vuln
			(0.9))
		(admin
			(0.0))
		(none
			(0.1))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
)
endobserve
cost (0.1)
endaction


action NOP
HAS_ROOT_VULN	 (SAMEHAS_ROOT_VULN)
HAS_C_DATA	 (SAMEHAS_C_DATA)
HAS_FAKE_DATA	 (SAMEHAS_FAKE_DATA)
SESSION_PRIVS	 (SAMESESSION_PRIVS)
PERSIST_GAINED	 (SAMEPERSIST_GAINED)
C_DATA_ACCESSED	 (SAMEC_DATA_ACCESSED)
FAKE_DATA_ACCESSED	 (SAMEFAKE_DATA_ACCESSED)
EXFIL_ONGOING	 (SAMEEXFIL_ONGOING)
observe
OBS	(OBS'
	(success
	(0.0))
	(vuln
	(0.0))
	(admin
	(0.0))
	(none
	(1.0))
	(user
	(0.0))
	(data_c
	(0.0))
	(data_nc
	(0.0))
)
endobserve
endaction


action PERSIST
HAS_ROOT_VULN	 (SAMEHAS_ROOT_VULN)
HAS_C_DATA	 (SAMEHAS_C_DATA)
HAS_FAKE_DATA	 (SAMEHAS_FAKE_DATA)
SESSION_PRIVS	 (SAMESESSION_PRIVS)
PERSIST_GAINED	(SESSION_PRIVS
	(admin
	(PERSIST_GAINED
		(admin
			(PERSIST_GAINED'
			(admin
					(1.0))
			(none
					(0.0))
			(user
					(0.0))
		))
		(none
			(PERSIST_GAINED'
			(admin
					(1.0))
			(none
					(0.0))
			(user
					(0.0))
		))
		(user
			(PERSIST_GAINED'
			(admin
					(1.0))
			(none
					(0.0))
			(user
					(0.0))
		))
	))
	(user
	(PERSIST_GAINED
		(admin
			(PERSIST_GAINED'
			(admin
					(1.0))
			(none
					(0.0))
			(user
					(0.0))
		))
		(none
			(PERSIST_GAINED'
			(admin
					(0.0))
			(none
					(0.1))
			(user
					(0.9))
		))
		(user
			(PERSIST_GAINED'
			(admin
					(0.0))
			(none
					(0.0))
			(user
					(1.0))
		))
	))
)
C_DATA_ACCESSED	 (SAMEC_DATA_ACCESSED)
FAKE_DATA_ACCESSED	 (SAMEFAKE_DATA_ACCESSED)
EXFIL_ONGOING	 (SAMEEXFIL_ONGOING)
observe
OBS	(PERSIST_GAINED'
	(admin
	(OBS'
		(success
			(1.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(0.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
	(none
	(OBS'
		(success
			(0.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(1.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
	(user
	(OBS'
		(success
			(1.0))
		(vuln
			(0.0))
		(admin
			(0.0))
		(none
			(0.0))
		(user
			(0.0))
		(data_c
			(0.0))
		(data_nc
			(0.0))
	))
)
endobserve
cost (0.2)
endaction


reward
(C_DATA_ACCESSED
	(no
	(EXFIL_ONGOING
		(no
			(0.0))
		(yes
			(0.0))
	))
	(yes
	(EXFIL_ONGOING
		(no
			(0.0))
		(yes
			(2.0))
	))
)
tolerance 0.001
discount 0.9
